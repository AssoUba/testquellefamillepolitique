
<!DOCTYPE html>
<html lang="fr">
<head>
  <meta charset="UTF-8">
  <title>Test Politique Étendu</title>
  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
</head>
<body>
  <h1>Test Politique Étendu – 40 Questions</h1>
  <form id="quizForm">
    
    <p>Q1. Question 1 (eco)<br>
    <input type="number" name="q0" data-axis="eco" min="-2" max="2" required></p>
    
    <p>Q2. Question 2 (aut)<br>
    <input type="number" name="q1" data-axis="aut" min="-2" max="2" required></p>
    
    <p>Q3. Question 3 (cul)<br>
    <input type="number" name="q2" data-axis="cul" min="-2" max="2" required></p>
    
    <p>Q4. Question 4 (eco_env)<br>
    <input type="number" name="q3" data-axis="eco_env" min="-2" max="2" required></p>
    
    <p>Q5. Question 5 (europe)<br>
    <input type="number" name="q4" data-axis="europe" min="-2" max="2" required></p>
    
    <p>Q6. Question 6 (eco)<br>
    <input type="number" name="q5" data-axis="eco" min="-2" max="2" required></p>
    
    <p>Q7. Question 7 (aut)<br>
    <input type="number" name="q6" data-axis="aut" min="-2" max="2" required></p>
    
    <p>Q8. Question 8 (cul)<br>
    <input type="number" name="q7" data-axis="cul" min="-2" max="2" required></p>
    
    <p>Q9. Question 9 (eco_env)<br>
    <input type="number" name="q8" data-axis="eco_env" min="-2" max="2" required></p>
    
    <p>Q10. Question 10 (europe)<br>
    <input type="number" name="q9" data-axis="europe" min="-2" max="2" required></p>
    
    <p>Q11. Question 11 (eco)<br>
    <input type="number" name="q10" data-axis="eco" min="-2" max="2" required></p>
    
    <p>Q12. Question 12 (aut)<br>
    <input type="number" name="q11" data-axis="aut" min="-2" max="2" required></p>
    
    <p>Q13. Question 13 (cul)<br>
    <input type="number" name="q12" data-axis="cul" min="-2" max="2" required></p>
    
    <p>Q14. Question 14 (eco_env)<br>
    <input type="number" name="q13" data-axis="eco_env" min="-2" max="2" required></p>
    
    <p>Q15. Question 15 (europe)<br>
    <input type="number" name="q14" data-axis="europe" min="-2" max="2" required></p>
    
    <p>Q16. Question 16 (eco)<br>
    <input type="number" name="q15" data-axis="eco" min="-2" max="2" required></p>
    
    <p>Q17. Question 17 (aut)<br>
    <input type="number" name="q16" data-axis="aut" min="-2" max="2" required></p>
    
    <p>Q18. Question 18 (cul)<br>
    <input type="number" name="q17" data-axis="cul" min="-2" max="2" required></p>
    
    <p>Q19. Question 19 (eco_env)<br>
    <input type="number" name="q18" data-axis="eco_env" min="-2" max="2" required></p>
    
    <p>Q20. Question 20 (europe)<br>
    <input type="number" name="q19" data-axis="europe" min="-2" max="2" required></p>
    
    <p>Q21. Question 21 (eco)<br>
    <input type="number" name="q20" data-axis="eco" min="-2" max="2" required></p>
    
    <p>Q22. Question 22 (aut)<br>
    <input type="number" name="q21" data-axis="aut" min="-2" max="2" required></p>
    
    <p>Q23. Question 23 (cul)<br>
    <input type="number" name="q22" data-axis="cul" min="-2" max="2" required></p>
    
    <p>Q24. Question 24 (eco_env)<br>
    <input type="number" name="q23" data-axis="eco_env" min="-2" max="2" required></p>
    
    <p>Q25. Question 25 (europe)<br>
    <input type="number" name="q24" data-axis="europe" min="-2" max="2" required></p>
    
    <p>Q26. Question 26 (eco)<br>
    <input type="number" name="q25" data-axis="eco" min="-2" max="2" required></p>
    
    <p>Q27. Question 27 (aut)<br>
    <input type="number" name="q26" data-axis="aut" min="-2" max="2" required></p>
    
    <p>Q28. Question 28 (cul)<br>
    <input type="number" name="q27" data-axis="cul" min="-2" max="2" required></p>
    
    <p>Q29. Question 29 (eco_env)<br>
    <input type="number" name="q28" data-axis="eco_env" min="-2" max="2" required></p>
    
    <p>Q30. Question 30 (europe)<br>
    <input type="number" name="q29" data-axis="europe" min="-2" max="2" required></p>
    
    <p>Q31. Question 31 (eco)<br>
    <input type="number" name="q30" data-axis="eco" min="-2" max="2" required></p>
    
    <p>Q32. Question 32 (aut)<br>
    <input type="number" name="q31" data-axis="aut" min="-2" max="2" required></p>
    
    <p>Q33. Question 33 (cul)<br>
    <input type="number" name="q32" data-axis="cul" min="-2" max="2" required></p>
    
    <p>Q34. Question 34 (eco_env)<br>
    <input type="number" name="q33" data-axis="eco_env" min="-2" max="2" required></p>
    
    <p>Q35. Question 35 (europe)<br>
    <input type="number" name="q34" data-axis="europe" min="-2" max="2" required></p>
    
    <p>Q36. Question 36 (eco)<br>
    <input type="number" name="q35" data-axis="eco" min="-2" max="2" required></p>
    
    <p>Q37. Question 37 (aut)<br>
    <input type="number" name="q36" data-axis="aut" min="-2" max="2" required></p>
    
    <p>Q38. Question 38 (cul)<br>
    <input type="number" name="q37" data-axis="cul" min="-2" max="2" required></p>
    
    <p>Q39. Question 39 (eco_env)<br>
    <input type="number" name="q38" data-axis="eco_env" min="-2" max="2" required></p>
    
    <p>Q40. Question 40 (europe)<br>
    <input type="number" name="q39" data-axis="europe" min="-2" max="2" required></p>
    
    <p><button type="submit">Soumettre</button></p>
  </form>
  <div id="result"></div>
  <canvas id="radarChart" width="400" height="400"></canvas>

  <script>
    document.getElementById("quizForm").onsubmit = async function(e) {
      e.preventDefault();
      const form = e.target;
      const inputs = form.querySelectorAll("input[type='number']");
      const answers = [];
      inputs.forEach(input => {
        let axis = input.dataset.axis;
        let val = parseInt(input.value);
        let obj = {eco: 0, aut: 0, cul: 0, eco_env: 0, europe: 0};
        obj[axis] = val;
        answers.push(obj);
      });
      const res = await fetch("/submit", {
        method: "POST",
        headers: { "Content-Type": "application/json" },
        body: JSON.stringify({ answers })
      });
      const data = await res.json();
      const scores = data.scores;
      const matches = data.matches;

      document.getElementById("result").innerHTML =
        "<h2>Résultats :</h2>" +
        "<pre>" + JSON.stringify(scores, null, 2) + "</pre>" +
        "<h3>Partis les plus proches :</h3><ul>" +
        matches.map(m => `<li>${m[0]} – ${m[1]}%</li>`).join("") + "</ul>";

      const ctx = document.getElementById("radarChart").getContext("2d");
      new Chart(ctx, {
        type: "radar",
        data: {
          labels: ["Économie", "Autorité", "Culture", "Écologie", "Europe"],
          datasets: [{
            label: "Votre profil",
            data: [scores.eco, scores.aut, scores.cul, scores.eco_env, scores.europe],
            fill: true,
            borderColor: "rgb(75, 192, 192)",
            backgroundColor: "rgba(75, 192, 192, 0.2)"
          }]
        },
        options: {
          responsive: true,
          scales: {
            r: { min: -2, max: 2, ticks: { stepSize: 1 } }
          }
        }
      });
    };
  </script>
</body>
</html>
